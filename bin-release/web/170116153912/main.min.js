var AssetAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var TitleWindow=function(t){function e(){t.call(this),this.offsetX=0,this.offsetY=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},n.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.show=function(){WindowService.getInstance().addToTopLayer(this),this.x=(AppService.getInstance().appWidth-this.width)/2+this.offsetX,this.y=(AppService.getInstance().appHeight-this.height)/2+this.offsetY},n.close=function(){this.parent&&this.parent.removeChild(this)},n.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i)},e}(eui.Panel);egret.registerClass(TitleWindow,"TitleWindow",["eui.UIComponent"]);var Alert=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i(s,"content",void 0,function(t){this._content=t,this.commitProperties()}),s.commitProperties=function(){t.prototype.commitProperties.call(this),this.contentDisplay&&(this.contentDisplay.text=this._content),this.okLabel&&this.closeButton&&(this.closeButton.label=this.okLabel)},s.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},s.onCloseButtonClick=function(e){t.prototype.onCloseButtonClick.call(this,e),this.okFun&&this.okFun()},e}(TitleWindow);egret.registerClass(Alert,"Alert");var PopHideTip=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i(s,"content",void 0,function(t){this._content=t,this.commitProperties()}),s.commitProperties=function(){t.prototype.commitProperties.call(this),this.contentDisplay&&(this.contentDisplay.text=this._content)},s.show=function(){t.prototype.show.call(this),this.alpha=0;var e=this.y;this.y=this.y+10;var i=egret.Tween.get(this);i.to({y:e,alpha:1},200),i.wait(3e3),i.to({alpha:0},400),i.call(this.effectCompleteHandler)},s.effectCompleteHandler=function(){this.close()},e}(TitleWindow);egret.registerClass(PopHideTip,"PopHideTip");var CurrentTargetUpdateEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.UPDATE_CURRENT_TARGET="UPDATE_CURRENT_TARGET",e}(egret.Event);egret.registerClass(CurrentTargetUpdateEvent,"CurrentTargetUpdateEvent");var GiftDataEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.GIFT_DATA_RES="GIFT_DATA_RES",e}(egret.Event);egret.registerClass(GiftDataEvent,"GiftDataEvent");var LoginServiceEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.LOGIN_OUT="loginOut",e.SAME_LOGIN="sameLogin",e.LOGIN_SUCCESS="loginSuccess",e.LOGIN_FAIL="loginFail",e}(egret.Event);egret.registerClass(LoginServiceEvent,"LoginServiceEvent");var MyGiftUpdateEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.UPDATE_MY_GIFTS="UPDATE_MY_GIFTS",e}(egret.Event);egret.registerClass(MyGiftUpdateEvent,"MyGiftUpdateEvent");var PlayGiftEffectEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.PLAY_GIFT_EFFECT="PLAY_GIFT_EFFECT",e}(egret.Event);egret.registerClass(PlayGiftEffectEvent,"PlayGiftEffectEvent");var UserInfoUpdateEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.UPDATE_USER_INFO="UPDATE_USER_INFO",e}(egret.Event);egret.registerClass(UserInfoUpdateEvent,"UserInfoUpdateEvent");var GiftAllView=function(t){function e(){t.call(this),this.curSelectID=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._listBg=new egret.Shape,this._listBg.graphics.beginFill(13024958),this._listBg.graphics.drawRoundRect(0,45,400,290,0,0),this._listBg.graphics.endFill(),this.addChild(this._listBg),this.gridUIGroup=new eui.Group,this.gridUIGroup.x=8,this.gridUIGroup.y=50,this.gridUIGroup.width=200,this.addChild(this.gridUIGroup);var e=new eui.TileLayout;e.paddingLeft=8,e.paddingTop=8,e.paddingRight=2,e.paddingBottom=2,e.requestedColumnCount=e.requestedRowCount=3,e.horizontalGap=e.verticalGap=5,this.gridUIGroup.layout=e,this.itemArr=new Array;for(var i,n=0;12>n;n++)i=new GiftGrid,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.gridUIGroup.addChild(i),this.itemArr.push(i);var s=new eui.Group;s.x=210,s.y=50,s.width=180,s.height=200;var a=new eui.VerticalLayout;s.layout=a,this.addChild(s);var r=ToolUtil.createLine(150,2,16711680);s.addChild(r),this._nameText=ToolUtil.createTextFiled("名字：",16,180,25,16711935,!0),s.addChild(this._nameText);var r=ToolUtil.createLine(150,2,16711680);s.addChild(r),this._priceText1=ToolUtil.createTextFiled("金币:",16,180,25,16711935,!0),s.addChild(this._priceText1),this._line2=ToolUtil.createLine(150,2,16711680),s.addChild(this._line2),this._priceText2=ToolUtil.createTextFiled("点劵:",16,180,25,16711935,!0),s.addChild(this._priceText2);var r=ToolUtil.createLine(150,2,16711680);s.addChild(r),this._descText=ToolUtil.createTextFiled("描述：",14,180,30,16711935),s.addChild(this._descText),this._countInput=new eui.TextInput,this._countInput.text="10",this._countInput.width=100,this._countInput.height=40,this._countInput.x=254,this._countInput.y=244,this.addChild(this._countInput),this._buyGroup=new eui.Group,this._buyGroup.width=180,this._buyGroup.x=210,this._buyGroup.y=284;var o=new eui.HorizontalLayout;o.horizontalAlign="center",this._buyGroup.layout=o,this.addChild(this._buyGroup),this._useBtn=new eui.Button,this._useBtn.label="金币购买",this._useBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUseBtn,this),this._buyGroup.addChild(this._useBtn),this._useBtn2=new eui.Button,this._useBtn2.label="点劵购买",this._useBtn2.visible=this._useBtn2.includeInLayout=!1,this._useBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUseBtn,this),this._buyGroup.addChild(this._useBtn2),GiftModule.getInstance().initGiftDataFlag?(this.giftList=GiftModule.getInstance().giftList,this.myGifts=GiftModule.getInstance().myGifts,this.updateGiftListItem()):GiftModule.getInstance().addEventListener(GiftDataEvent.GIFT_DATA_RES,this.onInitGiftData,this),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),this.dataService_gift=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.GIFT_SERVICE_ID),this.dataService_gift.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this)},n.onTouchUseBtn=function(t){var e=0;if(t.currentTarget==this._useBtn2&&(e=1),0!=this.curSelectID){var i=this.curSelectID,n=Number(this._countInput.text);if(this.curSelectID>0){var s=(GiftModule.getInstance().getGiftVOById(this.curSelectID),new BaseREQData);s.cmd=CmdUtil.BUY_GIFT_ADDITION,s.jsonObj={giftId:i,count:n,type:e},this.dataService_gift.sendData(s)}}},n.reveDataHandler=function(t){var e=t.data;e.serviceId==CmdUtil.GIFT_SERVICE_ID&&e.cmd==CmdUtil.BUY_GIFT_ADDITION_RES&&(3==e.jsonObj.code&&ToolUtil.createSureAlert("提示","金币不足",function(){},"玩游戏赚取金币",300,200),4==e.jsonObj.code?ToolUtil.createSureAlert("提示","点劵不足",function(){},"购买点劵",300,200):ToolUtil.createAlert("提示","购买成功",300,200))},n.updateGiftView=function(t){},n.onTouchTap=function(t){var e=t.currentTarget;if(e.item){this.curSelectID=e.item.id;for(var i=0;i<this.itemArr.length;i++)this.itemArr[i]!=e&&(this.itemArr[i].isSelected=!1);e.isSelected=!0,this._nameText.text="名字:"+e.item.name,this._descText.text="描述:"+e.item.desc,e.item.g_coin>0?(this._countInput.text="10",this._countInput.visible=!0):this._countInput.visible=!1,this._priceText1.visible=this._priceText1.includeInLayout=!0,this._priceText2.visible=this._priceText2.includeInLayout=!0,this._line2.visible=this._line2.includeInLayout=!0,0!=e.item.g_coin?(this._priceText1.text="金币:"+e.item.g_coin,this._useBtn.label="金币购买",this._useBtn.visible=this._useBtn.includeInLayout=!0):(this._priceText1.text="金币:不支持",this._useBtn.visible=this._useBtn.includeInLayout=!1),0!=e.item.m_coin?(this._priceText2.text="点劵:"+e.item.g_coin,this._useBtn2.visible=this._useBtn2.includeInLayout=!0):(this._priceText2.text="点劵:不支持",this._useBtn2.visible=this._useBtn2.includeInLayout=!1),0==e.item.g_coin&&0==e.item.m_coin&&(this._priceText1.text="价格:免费",this._priceText2.visible=this._priceText2.includeInLayout=!1,this._line2.visible=this._line2.includeInLayout=!1,this._useBtn2.visible=this._useBtn2.includeInLayout=!1,this._useBtn.visible=this._useBtn.includeInLayout=!0,this._useBtn.label="添加到包裹")}},n.onInitGiftData=function(t){this.giftList=t.giftList,this.myGifts=t.myGifts,this.updateGiftListItem()},n.updateGiftListItem=function(){if(this.giftList&&this.giftList.length>0&&this.itemArr)for(var t=0;t<this.giftList.length;t++)t<this.itemArr.length&&(this.itemArr[t].item=this.giftList[t]);this.itemArr.length>0&&0==this.curSelectID&&(this.curSelectID=this.itemArr[0].item.id,this.itemArr[0].dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP)))},n.getItemInfo=function(t){for(var e=0;e<this.giftList.length;e++)if(this.giftList[e].id==t)return this.giftList[e];return null},e}(eui.Component);egret.registerClass(GiftAllView,"GiftAllView");var GiftEffect=function(t){function e(){t.call(this),this.enabled=!1,AppService.getInstance().addEventListener(PlayGiftEffectEvent.PLAY_GIFT_EFFECT,this.playEffectHandler,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.playEffectHandler=function(t){var e=t.data,i=GiftModule.getInstance().getGiftVOById(e);i&&this.playEffect(i,1)},n.playEffect=function(t,e){if(void 0===e&&(e=1),t)switch(t.id){case 1:case 2:t.ack_0>0&&this.hitValueEff(t.ack_0,e),t.ack_1>0&&this.hitValueEff2(t.ack_1,e);break;default:t.ack_0>0&&this.hitValueEff(t.ack_0,e)}},n.hitValueEff2=function(t,e){var i=new egret.TextField;i.textColor=16711680*Math.random(),i.text=this.getValueString(t)+(e>1?"x"+e.toString():"")+"金币";var n=MonsterModule.getInstance().monsterPosition;i.x=n.x-150*Math.random(),i.y=n.y-100+50*Math.random(),this.addChild(i),egret.Tween.get(i).to({alpha:.5,y:i.y-100},1e3).call(function(){i&&i.parent&&i.parent.removeChild(i)},i)},n.hitValueEff=function(t,e){var i=new egret.TextField;i.textColor=16711680*Math.random(),i.text=this.getValueString(t)+(e>1?"x"+e.toString():"")+"魅力值";var n=MonsterModule.getInstance().monsterPosition;i.x=n.x+150*Math.random(),i.y=n.y-100+50*Math.random(),this.addChild(i),egret.Tween.get(i).to({alpha:.5,y:i.y-100},700).call(function(){i&&i.parent&&i.parent.removeChild(i)},i)},n.getValueString=function(t){var e;return e=0>t?t.toString():"+"+t.toString()},e}(eui.Component);egret.registerClass(GiftEffect,"GiftEffect");var GiftGrid=function(t){function e(){t.call(this),this._selctedColor1=15688417,this._selctedColor2=5682676,this._isSelected=!1,this._bg=new egret.Shape,this.addChild(this._bg),this.width=60,this.height=60,this.giftIcon=new egret.Bitmap,this.giftIcon.width=this.giftIcon.height=58,this.giftIcon.x=1,this.giftIcon.y=1,this.addChild(this.giftIcon)}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"item",function(){return this._item},function(t){if(this._item=t,this._item){var e="1000"+this._item.id+"_jpg",i=RES.getRes(e);this.giftIcon.texture=i}}),i(s,"isSelected",function(){return this._isSelected},function(t){this._isSelected=t,this._isSelected?this.filters=[new egret.GlowFilter(8735421,1,10,10,2,1)]:this.filters=null}),s.getItem=function(){return this._item},s.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i),this._bg.graphics.clear(),this._bg.graphics.lineStyle(1,16777215,.1),this._bg.graphics.beginFill(0,.15),this._bg.graphics.drawRect(0,0,e,i),this._bg.graphics.endFill()},e}(eui.Component);egret.registerClass(GiftGrid,"GiftGrid");var GiftListGroup=function(t){function e(){t.call(this),this.initView(),this.addEventListener(GiftDataEvent.GIFT_DATA_RES,this.onInitGiftData,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initView=function(){this._uiBmp=AssetsUtil.createBitmapByName("grid_bg_jpg"),this._uiBmp.width=this._uiBmp.height=200,this.addChild(this._uiBmp),this.gridUIGroup=new eui.Group,this.gridUIGroup.width=200,this.addChild(this.gridUIGroup);var t=new eui.TileLayout;t.paddingLeft=8,t.paddingTop=8,t.paddingRight=2,t.paddingBottom=2,t.requestedColumnCount=t.requestedRowCount=3,t.horizontalGap=t.verticalGap=2,this.gridUIGroup.layout=t,this.itemArr=new Array;for(var e,i=0;9>i;i++)e=new GiftGrid,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.gridUIGroup.addChild(e),this.itemArr.push(e)},n.updateGiftView=function(t){},n.onTouchTap=function(t){var e=t.currentTarget;if(e.item){e.isSelected=!0;for(var i=0;i<this.itemArr.length;i++)this.itemArr[i]!=e&&(this.itemArr[i].isSelected=!1)}},n.onInitGiftData=function(t){this.giftList=t.giftList,this.myGifts=t.myGifts,this.updateGiftListItem()},n.updateGiftListItem=function(){if(this.giftList&&this.giftList.length>0&&this.itemArr)for(var t=0;t<this.giftList.length;t++)t<this.itemArr.length&&(this.itemArr[t].item=this.giftList[t])},e}(eui.Group);egret.registerClass(GiftListGroup,"GiftListGroup");var GiftModule=function(t){function e(){t.call(this),this.initGiftDataFlag=!1,this.dataService_gift=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.GIFT_SERVICE_ID),this.dataService_gift.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),this.getGiftsData()}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.showList=function(){this._giftSetView||(this._giftSetView=new GiftWin,this._giftSetView.title="礼物组合设置",this._giftSetView.width=400,this._giftSetView.height=450),this._giftSetView.show()},n.reveDataHandler=function(t){var e=t.data;if(e.serviceId==CmdUtil.GIFT_SERVICE_ID)switch(e.cmd){case CmdUtil.INIT_GIFTS_DATA_RES:this.doResGiftsData(e);break;case CmdUtil.SEND_GIFT_RES:this.doResSendGifts(e);break;case CmdUtil.LIST_MY_GIFTS_RES:this.doResMyGifts(e)}},n.doResMyGifts=function(t){var e=t.jsonObj;this.myGifts.length=0,this.doMyGifts(e);var i=new MyGiftUpdateEvent(MyGiftUpdateEvent.UPDATE_MY_GIFTS);i.data=this.myGifts,AppService.getInstance().dispatchEvent(i)},n.doMyGifts=function(t){this.myGifts=new Array;for(var e=0;e<t.length;e++)this.myGifts.push(t[e])},n.doResGiftsData=function(t){var e=t.code,i=t.jsonObj;if(console.log(i),1==e&&i){var n=new GiftDataEvent(GiftDataEvent.GIFT_DATA_RES);this.giftList=new Array;var s,a=i.gifts,r=i.myGifts,o=0;for(o=0;o<a.length;o++)s=new GiftInfoVO,s.id=a[o].id,s.ack_0=a[o].ack_0,s.ack_1=a[o].ack_1,s.createTime=a[o].createTime,s.g_coin=a[o].g_coin,s.isLock=a[o].isLock,s.m_coin=a[o].m_coin,s.name=a[o].name,s.desc=a[o].desc,this.giftList.push(s);this.doMyGifts(r),this.initGiftDataFlag=!0,n.giftList=this.giftList,n.myGifts=this.myGifts,this.dispatchEvent(n)}},n.getGiftVOById=function(t){for(var e=0;e<this.giftList.length;e++){var i=this.giftList[e];if(i.id==t)return i}return null},n.getMyGiftById=function(t){for(var e=0;e<this.myGifts.length;e++){var i=this.myGifts[e];if(i.giftId==t)return i}return null},n.doResSendGifts=function(t){var e=t.code,i=t.jsonObj;if(egret.log(JSON.stringify(t.jsonObj)),egret.log("doResSendGifts----"+JSON.stringify(t)),1==e){var i=t.jsonObj,n=i.giftIds;if(n.length>0){var s=new CurrentTargetUpdateEvent(CurrentTargetUpdateEvent.UPDATE_CURRENT_TARGET);s.data=i.userTarget,AppService.getInstance().dispatchEvent(s)}for(var a=0;a<n.length;a++){var r=new PlayGiftEffectEvent(PlayGiftEffectEvent.PLAY_GIFT_EFFECT);r.data=n[a],r.count=1,AppService.getInstance().dispatchEvent(r)}}else if(3==e){var o=new PopHideTip;o.width=200,o.height=100,o.content="余额不足",o.show()}},n.getGiftsData=function(){var t=new BaseREQData;t.cmd=CmdUtil.INIT_GIFTS_DATA,t.jsonObj={},this.dataService_gift.sendData(t)},n.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i)},e}(eui.Component);egret.registerClass(GiftModule,"GiftModule");var GiftMyPackView=function(t){function e(){t.call(this),this.curSelectID=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._listBg=new egret.Shape,this._listBg.graphics.beginFill(13024958),this._listBg.graphics.drawRoundRect(0,45,400,290,0,0),this._listBg.graphics.endFill(),this.addChild(this._listBg),this.gridUIGroup=new eui.Group,this.gridUIGroup.x=8,this.gridUIGroup.y=50,this.gridUIGroup.width=200,this.addChild(this.gridUIGroup);var e=new eui.TileLayout;e.paddingLeft=8,e.paddingTop=8,e.paddingRight=2,e.paddingBottom=2,e.requestedColumnCount=e.requestedRowCount=3,e.horizontalGap=e.verticalGap=5,this.gridUIGroup.layout=e,this.itemArr=new Array;for(var i,n=0;12>n;n++)i=new GiftGrid,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.gridUIGroup.addChild(i),this.itemArr.push(i);this.labelGroup=new eui.Group,this.labelGroup.x=210,this.labelGroup.y=50,this.labelGroup.width=180,this.labelGroup.height=200;var s=new eui.VerticalLayout;this.labelGroup.layout=s,this.addChild(this.labelGroup);var a=ToolUtil.createLine(150,2,16711680);this.labelGroup.addChild(a),this._nameText=ToolUtil.createTextFiled("名字：",16,180,30,16711935,!0),this.labelGroup.addChild(this._nameText);var a=ToolUtil.createLine(150,2,16711680);this.labelGroup.addChild(a),this._priceText=ToolUtil.createTextFiled("金币：",16,180,30,16711935,!0),this.labelGroup.addChild(this._priceText),this._line2=ToolUtil.createLine(150,2,16711680),this.labelGroup.addChild(this._line2),this._priceText2=ToolUtil.createTextFiled("点劵:",16,180,25,16711935,!0),this.labelGroup.addChild(this._priceText2);var a=ToolUtil.createLine(150,2,16711680);this.labelGroup.addChild(a),this._descText=ToolUtil.createTextFiled("描述：",14,180,30,16711935),this.labelGroup.addChild(this._descText);var a=ToolUtil.createLine(100,2,16711680);this.labelGroup.addChild(a),this._numberText=ToolUtil.createTextFiled("剩余个数：",14,180,30,16711935),this.labelGroup.addChild(this._numberText),this._useBtn=new eui.Button,this._useBtn.label="添加到组合",this._useBtn.x=245,this._useBtn.y=284,this._useBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUseBtn,this),this.addChild(this._useBtn),this.labelGroup.visible=!1,this._useBtn.visible=!1,GiftModule.getInstance().initGiftDataFlag?(this.myGifts=GiftModule.getInstance().myGifts,this.updateGiftListItem()):GiftModule.getInstance().addEventListener(GiftDataEvent.GIFT_DATA_RES,this.onInitGiftData,this),AppService.getInstance().addEventListener(MyGiftUpdateEvent.UPDATE_MY_GIFTS,this.updateMyGiftsHandler,this),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this)},n.reveDataHandler=function(t){var e=t.data;if(e.serviceId==CmdUtil.CONFIG_SERVICE_ID)if(e.cmd==CmdUtil.ADD_GIFT_ADDITION_GROUP_RES){if(1==e.code){ToolUtil.createAlert("提示","操作成功",300,200);var i=e.jsonObj,n=GiftModule.getInstance().getMyGiftById(i);n.isGroup=!0,this.curSelectItem.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))}}else if(e.cmd==CmdUtil.DELETE_GIFT_ADDITION_GROUP_RES&&1==e.code){ToolUtil.createAlert("提示","操作成功",300,200);var i=e.jsonObj,n=GiftModule.getInstance().getMyGiftById(i);n.isGroup=!1,this.curSelectItem.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))}},n.onTouchUseBtn=function(t){if(0!=this.curSelectID){var e=this.curSelectID,i=GiftModule.getInstance().getMyGiftById(e);if(i.isGroup){var n=new BaseREQData;n.cmd=CmdUtil.DELETE_GIFT_ADDITION_GROUP,n.jsonObj={giftId:e},this.dataService_config.sendData(n)}else{var n=new BaseREQData;n.cmd=CmdUtil.ADD_GIFT_ADDITION_GROUP,n.jsonObj={giftId:e},this.dataService_config.sendData(n)}}},n.onTouchTap=function(t){var e=t.currentTarget;if(this.curSelectItem=e,e.item){this.curSelectID=e.item.id;for(var i=0;i<this.itemArr.length;i++)this.itemArr[i]!=e&&(this.itemArr[i].isSelected=!1);e.isSelected=!0,this._nameText.text="名字:"+e.item.name,this._descText.text="描述:"+e.item.desc,this._line2.visible=this._line2.includeInLayout=!0,this._priceText2.visible=this._priceText2.includeInLayout=!0;var n=GiftModule.getInstance().getMyGiftById(e.item.id);0!=e.item.g_coin?(this._priceText.text="金币:"+e.item.g_coin,this._numberText.text="剩余个数:"+n.count):this._priceText.text="金币:不支持",0!=e.item.m_coin?(this._priceText2.text="点劵:"+e.item.m_coin,this._numberText.text="剩余个数:"+n.count):this._priceText2.text="点劵:不支持",0==e.item.g_coin&&0==e.item.m_coin&&(this._numberText.text="剩余个数:无限制",this._priceText.text="价格:免费",this._priceText2.visible=this._priceText2.includeInLayout=!1,this._line2.visible=this._line2.includeInLayout=!1),n.isGroup?this._useBtn.label="从组合里移除":this._useBtn.label="添加到组合",this.labelGroup.visible=!0,this._useBtn.visible=!0}},n.updateMyGiftsHandler=function(t){this.myGifts=t.data,this.updateGiftListItem()},n.onInitGiftData=function(t){this.myGifts=t.myGifts,this.updateGiftListItem()},n.updateGiftListItem=function(){if(this.myGifts&&this.myGifts.length>0&&this.itemArr)for(var t=0;t<this.myGifts.length;t++)if(t<this.itemArr.length){var e=this.myGifts[t],i=GiftModule.getInstance().getGiftVOById(e.giftId);(e.count>0||0==i.g_coin)&&(this.itemArr[t].item=i)}this.itemArr.length>0&&0==this.curSelectID&&(this.curSelectID=this.itemArr[0].item.id,this.itemArr[0].dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP)))},e}(eui.Component);egret.registerClass(GiftMyPackView,"GiftMyPackView");var GiftWin=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.giftAllView=new GiftAllView,this.giftAllView.width=400,this.giftAllView.height=400,this.giftAllView.y=45,this.addChild(this.giftAllView),this.giftMyPackView=new GiftMyPackView,this.giftMyPackView.width=400,this.giftMyPackView.height=400,this.giftMyPackView.y=45,this.giftMyPackView.visible=!1,this.addChild(this.giftMyPackView),this.btn1=new eui.ToggleButton,this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapItem,this),this.btn1.y=40,this.btn1.label="所有礼物",this.addChild(this.btn1),this.btn2=new eui.ToggleButton,this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapItem,this),this.btn2.y=40,this.btn2.x=100,this.btn2.label="我的包裹",this.addChild(this.btn2)},n.onTouchTapItem=function(t){var e=t.currentTarget;this.btn1.selected=!1,this.btn2.selected=!1,e.selected=!0,e==this.btn1?(this.giftAllView.visible=!0,this.giftMyPackView.visible=!1):e==this.btn2&&(this.giftAllView.visible=!1,this.giftMyPackView.visible=!0)},e}(TitleWindow);egret.registerClass(GiftWin,"GiftWin");var GiftInfoVO=function(){function t(){this.g_coin=0,this.m_coin=0}var e=(__define,t);e.prototype;return t}();egret.registerClass(GiftInfoVO,"GiftInfoVO");var HPBarModule=function(t){function e(){t.call(this),this._maxCalWidth=340,this.width=344,this.height=15,this.createBg(),this.createItemHP(),this.createLabel(),this.updateItemHP(this._maxCalWidth),AppService.getInstance().addEventListener(UserInfoUpdateEvent.UPDATE_USER_INFO,this.userInfoUpdateHandler,this),AppService.getInstance().addEventListener(CurrentTargetUpdateEvent.UPDATE_CURRENT_TARGET,this.currentTargetUpdateHandler,this),this.dataService_target=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.TARGET_SERVICE_ID),this.dataService_target.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),this.initTargetData(),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.initTargetData=function(){var t=new BaseREQData;t.cmd=CmdUtil.INIT_TARGETS_DATA,t.jsonObj={},this.dataService_target.sendData(t)},n.doResAutoGiftsData=function(t){var e=t.code,i=t.jsonObj;if(console.log(JSON.stringify(i)),1==e&&i){for(var n=i.giftIdsList,s=i.giftIdsCountList,a=0;a<n.length;a++)if(n[a]){var r=new PlayGiftEffectEvent(PlayGiftEffectEvent.PLAY_GIFT_EFFECT);r.data=n[a],r.count=s[a],AppService.getInstance().dispatchEvent(r)}if(i.userTarget){var o=new CurrentTargetUpdateEvent(CurrentTargetUpdateEvent.UPDATE_CURRENT_TARGET);o.data=i.userTarget,AppService.getInstance().dispatchEvent(o)}}},n.reveDataHandler=function(t){var e=t.data;if(e.serviceId==CmdUtil.TARGET_SERVICE_ID)switch(e.cmd){case CmdUtil.INIT_TARGETS_DATA_RES:this.doResTargetData(e)}else if(e.serviceId==CmdUtil.CONFIG_SERVICE_ID)switch(e.cmd){case CmdUtil.UPDATE_AUTO_GIFTS_DATA:this.doResAutoGiftsData(e)}},n.doResTargetData=function(t){var e=(t.code,t.jsonObj);this.doUserTargetData(e.currentTarget)},n.createLabel=function(){this._label=new egret.TextField,this._label.width=100,this._label.size=15,this._label.x=this.width+2,this._label.y=0,this._label.textColor=13421823,this._label.fontFamily="宋体",this._label.textAlign=egret.HorizontalAlign.LEFT,this._label.verticalAlign=egret.VerticalAlign.TOP,this._label.strokeColor=255,this._label.stroke=2,this.addChild(this._label),this._labelAck_0=new egret.TextField,this._labelAck_0.width=100,this._labelAck_0.size=15,this._labelAck_0.x=this.width/2-20,this._labelAck_0.y=20,this._labelAck_0.textColor=16711680,this._labelAck_0.fontFamily="宋体",this._labelAck_0.textAlign=egret.HorizontalAlign.LEFT,this._labelAck_0.verticalAlign=egret.VerticalAlign.TOP,this._labelAck_0.strokeColor=65535,this._labelAck_0.stroke=2,this.addChild(this._labelAck_0)},n.createBg=function(){this._bg||(this._bg=new egret.Shape,this.addChild(this._bg)),this._bg.graphics.clear(),this._bg.graphics.beginFill(16099024),this._bg.graphics.drawRoundRect(0,0,this.width,this.height,20,15),this._bg.graphics.endFill()},n.createItemHP=function(){this._itemHP=new egret.Shape,this._itemHP.x=2,this._itemHP.y=2,this.addChild(this._itemHP)},n.updateItemHP=function(t){this._itemHP&&(this._itemHP.graphics.clear(),this._itemHP.graphics.beginFill(16711782),this._itemHP.graphics.drawRoundRect(0,0,t,this.height-4,20,15),this._itemHP.graphics.endFill())},n.userInfoUpdateHandler=function(t){if(t.data){var e=t.data;this._label.text=e.get_litile_in_cur_gate+"/"+e.total_litile_in_gate}},n.currentTargetUpdateHandler=function(t){if(t.data){var e=t.data;this.doUserTargetData(e)}},n.doUserTargetData=function(t){var e=t.toMyAck_0/t.total_ack_0*this._maxCalWidth;e>this._maxCalWidth&&(e=this._maxCalWidth),this.updateItemHP(e),this._labelAck_0.text=t.toMyAck_0+"/"+t.total_ack_0},e}(eui.Component);egret.registerClass(HPBarModule,"HPBarModule");var BgModule=function(t){function e(){t.call(this),this._bg=new egret.Shape,this.addChild(this._bg),this.createBG()}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.createBG=function(){this._bgBmp=this.createBitmapByName("bg_jpg"),this.addChild(this._bgBmp)},n.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},n.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i),this._bg.graphics.clear(),this._bg.graphics.beginFill(255),this._bg.graphics.drawRect(0,0,e,i),this._bg.graphics.endFill(),this._bgBmp&&(this._bgBmp.width=e,this._bgBmp.height=i)},e}(eui.Component);egret.registerClass(BgModule,"BgModule");var RankInfoModule=function(t){function e(){t.call(this),this._rankIcon=AssetsUtil.createBitmapByName("rank_btn_jpg"),this.addChild(this._rankIcon),this._rankIcon.x=2,this._rankIcon.y=90,this._rankIcon.touchEnabled=!0,this._rankIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.dataService_rankInfo=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.UESRINGO_SERVICE_ID),this.dataService_rankInfo.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.onTouchTap=function(t){this._rankView||(this._rankView=new RankView,this._rankView.title="排行榜",this._rankView.width=400,this._rankView.height=630),this._rankView.show(),this.getRankInfoData(1,15)},n.reveDataHandler=function(t){var e=t.data;e.serviceId==CmdUtil.UESRINGO_SERVICE_ID&&e.cmd==CmdUtil.GET_RANK_DATA_RES&&this.doResRankInfoData(e)},n.doResRankInfoData=function(t){var e=(t.code,t.notice,t.jsonObj);console.log("返回排行榜数据！！！！！"),this._rankView&&this._rankView.updateView(e)},n.getRankInfoData=function(t,e){var i=new BaseREQData;i.cmd=CmdUtil.GET_RANK_DATA,i.jsonObj=new Object,i.jsonObj.currentPage=1,i.jsonObj.perPageSize=e,this.dataService_rankInfo.sendData(i)},n.createLab=function(){this.invalidateDisplayList()},e}(eui.Component);egret.registerClass(RankInfoModule,"RankInfoModule");var RankItem=function(t){function e(){t.call(this),this._bg=new egret.Shape,this._bg.graphics.clear(),this._bg.graphics.beginFill(13296127),this._bg.graphics.drawRoundRect(0,0,380,30,20,15),this._bg.graphics.endFill(),this.addChild(this._bg),this._rankLab=this.createLab("",10,8,14,50,30,0),this.addChild(this._rankLab),this._nameLab=this.createLab("",95,8,14,100,30,0),this.addChild(this._nameLab),this._peopleNumLab=this.createLab("",215,8,14,200,30,0),this.addChild(this._peopleNumLab)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setData=function(t){this._data=t,this._rankLab.text="第"+t.rank+"名",this._nameLab.text="姓名:"+t.nick,this._peopleNumLab.textFlow=[{text:"泡到素人:",style:{size:12}},{text:t.litileTargetNum,style:{textColor:3368601,size:12,strokeColor:6724044,stroke:.5}},{text:"个",style:{size:12}}]},n.getData=function(){return this._data},n.createLab=function(t,e,i,n,s,a,r){var o=new egret.TextField;return o.size=n,o.width=s,o.textColor=r,o.fontFamily="宋体",o.textAlign=egret.HorizontalAlign.LEFT,o.verticalAlign=egret.VerticalAlign.TOP,o.text=t,o.x=e,o.y=i,o},e}(eui.Component);egret.registerClass(RankItem,"RankItem");var RankView=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemUIGroup=new eui.Group,this.itemUIGroup.width=400,this.itemUIGroup.height=520,this.itemUIGroup.x=10,this.itemUIGroup.y=49,this.addChild(this.itemUIGroup),this._rankItemVec=new Array;for(var e,i=0;15>i;i++)e=new RankItem,e.includeInLayout=!1,e.visible=!1,this.itemUIGroup.addChild(e),this._rankItemVec.push(e);var n=new eui.VerticalLayout;n.gap=35,this.itemUIGroup.layout=n},n.updateView=function(t){console.log(t);for(var e,i=t.currentPage,n=t.pageItems,s=0;s<n.length;s++)e=new Object,e.rank=s+1+15*(i-1),e.nick=n[s].nick,e.uid=n[s].uid,e.litileTargetNum=n[s].litileTargetNum,this._rankItemVec[s].setData(e),this._rankItemVec[s].visible=this._rankItemVec[s].includeInLayout=!0},n.commitProperties=function(){t.prototype.commitProperties.call(this)},e}(TitleWindow);egret.registerClass(RankView,"RankView");var Role=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initHero=function(){this._myType=Role_Type.ROLE_HERO},n.initMonster=function(){this._myType=Role_Type.ROLE_MONSTER
},n.getRoleType=function(){return this._myType},e}(eui.Component);egret.registerClass(Role,"Role");var Role_Type;!function(t){t[t.ROLE_HERO=0]="ROLE_HERO",t[t.ROLE_MONSTER=1]="ROLE_MONSTER",t[t.ROLE_NULL=2]="ROLE_NULL"}(Role_Type||(Role_Type={}));var Monster=function(t){function e(){t.call(this),this.initMonster()}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"HP",function(){return this._hp},function(t){this._hp=t}),e}(Role);egret.registerClass(Monster,"Monster");var MonsterModule=function(t){function e(){t.call(this),this._suren=new SuRen,this.addChild(this._suren),this._suren.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapSuren,this),AppService.getInstance().addEventListener(CurrentTargetUpdateEvent.UPDATE_CURRENT_TARGET,this.currentTargetUpdateHandler,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},s.updateView=function(){this._suren&&(this._suren.x=(this.width-this._suren.width)/2,this._suren.y=780*this.height/1092)},i(s,"monsterPosition",function(){var t=new egret.Point;return this._suren&&(t.x=this._suren.x,t.y=this._suren.y),t}),s.currentTargetUpdateHandler=function(t){t.data&&this._suren&&this._suren.playEffect()},s.onTouchTapSuren=function(t){UseModule.getInstance().sendCurrentGifts()},e}(eui.Component);egret.registerClass(MonsterModule,"MonsterModule");var SuRen=function(t){function e(){t.call(this);var e=RES.getRes("suren_json"),i=RES.getRes("suren_png"),n=new egret.MovieClipDataFactory(e,i);this._suren=new egret.MovieClip(n.generateMovieClipData("MC_Suren")),this._suren.x=-this._suren.width/2,this._suren.y=-this._suren.height,this.addChild(this._suren)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.playEffect=function(){this._suren.gotoAndPlay(1)},e}(Monster);egret.registerClass(SuRen,"SuRen");var ShopItem=function(t){function e(){t.call(this),this._bg=new egret.Shape,this._bg.graphics.clear(),this._bg.graphics.beginFill(13296127),this._bg.graphics.drawRoundRect(0,0,380,120,20,15),this._bg.graphics.endFill(),this.addChild(this._bg),this._gift_bg=AssetsUtil.createBitmapByName("gift_bg_jpg"),this._gift_bg.x=5,this._gift_bg.y=5,this.addChild(this._gift_bg),this._giftBagIcon=new egret.Bitmap,this._giftBagIcon.x=5,this._giftBagIcon.y=5,this.addChild(this._giftBagIcon),this._nameLab=this.createLab("",65,3,14,225,30,0),this.addChild(this._nameLab),this._descLab=this.createLab("",65,19,12,310,30,0),this.addChild(this._descLab),this._price_g_Lab=this.createLab("",100,50,14,100,30,0),this.addChild(this._price_g_Lab),this._price_m_Lab=this.createLab("",230,50,14,100,30,0),this.addChild(this._price_m_Lab),this._price_g_Lab.visible=!1,this._price_m_Lab.visible=!1,this._buy_gBtn=new eui.Button,this._buy_gBtn.visible=!1,this._buy_gBtn.label="购买",this._buy_gBtn.x=70,this._buy_gBtn.y=70,this._buy_gBtn.height=40,this._buy_gBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyBtn,this),this.addChild(this._buy_gBtn),this._buy_mBtn=new eui.Button,this._buy_mBtn.visible=!1,this._buy_mBtn.label="购买",this._buy_mBtn.x=200,this._buy_mBtn.y=70,this._buy_mBtn.height=40,this._buy_mBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyBtn,this),this.addChild(this._buy_mBtn)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setData=function(t){this._data=t,this._nameLab.text=t.name,this._descLab.text=t.desc,this._price_g_Lab.textFlow=(new egret.HtmlTextParser).parser('<font color="#ff7f50" size="14"><b>'+t.g_coin+"金币</b></font>"),this._price_m_Lab.textFlow=(new egret.HtmlTextParser).parser('<font color="#ff7f50" size="14"><b>'+t.m_coin+"点券</b></font>"),t.g_coin>0&&(this._buy_gBtn.visible=!0,this._price_g_Lab.visible=!0),t.m_coin>0&&(this._buy_mBtn.visible=!0,this._price_m_Lab.visible=!0)},n.onBuyBtn=function(t){switch(t.currentTarget){case this._buy_gBtn:this._data&&(this._data.g_coin>0?ShopModule.getInstance().getBuyGiftsData(this._data.id,0):ToolUtil.createAlert("提示","暂不支持金币购买"));break;case this._buy_mBtn:this._data&&(this._data.m_coin>0?ShopModule.getInstance().getBuyGiftsData(this._data.id,1):ToolUtil.createAlert("提示","暂不支持点券购买"))}},n.setGiftBagIcon=function(t){var e=RES.getRes(t);this._giftBagIcon&&(this._giftBagIcon.texture=e)},n.getData=function(){return this._data},n.createLab=function(t,e,i,n,s,a,r){var o=new egret.TextField;return o.size=n,o.width=s,o.textColor=r,o.fontFamily="宋体",o.textAlign=egret.HorizontalAlign.LEFT,o.verticalAlign=egret.VerticalAlign.TOP,o.text=t,o.x=e,o.y=i,o},e}(eui.Component);egret.registerClass(ShopItem,"ShopItem");var ShopModule=function(t){function e(){t.call(this),this._shopIcon=AssetsUtil.createBitmapByName("shop_btn_jpg"),this.addChild(this._shopIcon),this._shopIcon.x=2,this._shopIcon.y=140,this._shopIcon.touchEnabled=!0,this._shopIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.dataService_shopInfo=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.SHOP_LIST_SERVICE_ID),this.dataService_shopInfo.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.onTouchTap=function(t){this._shopView||(this._shopView=new ShopView,this._shopView.title="商店",this._shopView.width=400,this._shopView.height=630),this._shopView.show(),this.getShopInfoData(1,15)},n.reveDataHandler=function(t){var e=t.data;e.serviceId==CmdUtil.SHOP_LIST_SERVICE_ID&&(e.cmd==CmdUtil.GET_SHOP_DATA_RES?this.doResShopInfoData(e):e.cmd==CmdUtil.BUY_COMMIDITY_DATA_RES&&this.doResBuyGiftBackData(e))},n.doResShopInfoData=function(t){var e=(t.code,t.notice,t.jsonObj);console.log("返回商店数据！！！！！"),this._shopView&&this._shopView.updateView(e)},n.doResBuyGiftBackData=function(t){var e=(t.code,t.notice,t.jsonObj);1==e.status?ToolUtil.createAlert("提示","购买礼包成功"):0==e.status&&ToolUtil.createAlert("提示","余额不足")},n.getShopInfoData=function(t,e){var i=new BaseREQData;i.cmd=CmdUtil.GET_SHOP_DATA,i.jsonObj=new Object,i.jsonObj.currentPage=1,i.jsonObj.perPageSize=e,this.dataService_shopInfo.sendData(i)},n.getBuyGiftsData=function(t,e){var i=new BaseREQData;i.cmd=CmdUtil.BUY_COMMIDITY_DATA,i.jsonObj=new Object,i.jsonObj.commodityId=t,i.jsonObj.useType=e,this.dataService_shopInfo.sendData(i)},n.createLab=function(){},e}(eui.Component);egret.registerClass(ShopModule,"ShopModule");var ShopView=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemUIGroup=new eui.Group,this.itemUIGroup.width=400,this.itemUIGroup.height=520,this.itemUIGroup.x=10,this.itemUIGroup.y=49,this.addChild(this.itemUIGroup),this._shopItemVec=new Array;for(var e,i=0;15>i;i++)e=new ShopItem,e.includeInLayout=!1,e.visible=!1,this.itemUIGroup.addChild(e),this._shopItemVec.push(e);var n=new eui.VerticalLayout;n.gap=60,this.itemUIGroup.layout=n},n.updateView=function(t){console.log(t);for(var e,i=(t.currentPage,t.pageItems),n=0;n<i.length;n++)e=new Object,e.id=i[n].id,e.name=i[n].name,e.desc=i[n].desc,e.g_coin=i[n].g_coin,e.m_coin=i[n].m_coin,e.giftId1=i[n].giftId1,e.giftId1_count=i[n].giftId1_count,e.giftId2=i[n].giftId2,e.giftId2_count=i[n].giftId2_count,e.giftId3=i[n].giftId3,e.giftId3_count=i[n].giftId3_count,this._shopItemVec[n].setData(e),this._shopItemVec[n].visible=this._shopItemVec[n].includeInLayout=!0},n.commitProperties=function(){t.prototype.commitProperties.call(this)},e}(TitleWindow);egret.registerClass(ShopView,"ShopView");var UseItem=function(t){function e(){t.call(this),this._isSelected=!1,this._bg=new egret.Shape,this.addChild(this._bg),this._main=new eui.Component,this.addChild(this._main),this._giftIcon=new egret.Bitmap,this._giftIcon.width=this._giftIcon.height=88,this._giftIcon.x=1,this._giftIcon.y=1,this._main.addChild(this._giftIcon),this._label=new egret.TextField,this._label.width=100,this._label.size=15,this._label.x=0,this._label.y=0,this._label.textColor=13421823,this._label.fontFamily="宋体",this._label.textAlign=egret.HorizontalAlign.LEFT,this._label.verticalAlign=egret.VerticalAlign.TOP,this._label.strokeColor=255,this._label.stroke=2,this._main.addChild(this._label),this._deleteIcon=new egret.Bitmap,this._deleteIcon.touchEnabled=!0,this._deleteIcon.width=this._deleteIcon.height=55,this._deleteIcon.x=33,this._deleteIcon.y=-55;var e="delete__png",i=RES.getRes(e);this._deleteIcon.texture=i,this._deleteIcon.visible=!1,this._main.addChild(this._deleteIcon),this._deleteIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDeleteBtn,this),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),AppService.getInstance().addEventListener(MyGiftUpdateEvent.UPDATE_MY_GIFTS,this.updateCountHandle,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.reveDataHandler=function(t){var e=t.data;e.serviceId==CmdUtil.CONFIG_SERVICE_ID},s.onTouchDeleteBtn=function(t){t.stopImmediatePropagation();var e=this._item.id,i=new BaseREQData;i.cmd=CmdUtil.DELETE_GIFT_ADDITION_GROUP,i.jsonObj={giftId:e},this.dataService_config.sendData(i)},s.updateCountHandle=function(t){if(this._item){var e=GiftModule.getInstance().getMyGiftById(this._item.id),i=e.count;this._label.text=i.toString(),0==this._item.g_coin?0==i&&(this._label.text="免费"):0==i&&(this._label.text="已用完"),this.isSelected=e.isUsing}},s.getItem=function(){return this._item},i(s,"item",void 0,function(t){if(this._item!=t&&(this._item=t,this._item)){var e="1000"+this._item.id+"_jpg",i=RES.getRes(e);this._giftIcon.texture=i,this._deleteIcon.visible=!0,this.updateCountHandle(null)}}),i(s,"isSelected",function(){return this._isSelected},function(t){this._isSelected=t,this._isSelected?this.filters=[new egret.GlowFilter(65280,1,10,10,2,1)]:this.filters=null;var e=GiftModule.getInstance().getMyGiftById(this._item.id);this._item.g_coin>0&&0==e.count&&(this.filters=null)}),s.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i),this._bg.graphics.clear(),this._bg.graphics.beginFill(16711680,.5),this._bg.graphics.drawRect(0,0,e,i),this._bg.graphics.endFill()},s.depose=function(){return this.dataService_config.removeEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),AppService.getInstance().removeEventListener(MyGiftUpdateEvent.UPDATE_MY_GIFTS,this.updateCountHandle,this),!0},e}(eui.Component);egret.registerClass(UseItem,"UseItem");var UseModule=function(t){function e(){t.call(this),this.curSelectIDS=[],this.width=370,this.height=90,this._bg=new egret.Shape,this.addChild(this._bg),this._listGroup=new eui.Group,this._listGroup.minWidth=180,this._listGroup.x=0,this._listGroup.y=0,this.addChild(this._listGroup);var e=new eui.TileLayout;e.requestedColumnCount=e.requestedRowCount=4,e.horizontalGap=e.verticalGap=2,this._listGroup.layout=e,this._btn=new eui.Button,this._btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnHandler,this),this._btn.width=100,this._btn.height=90,this._btn.label="礼物组合",this._btn.x=180,this.addChild(this._btn),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),GiftModule.getInstance().initGiftDataFlag?this.updateUseView():GiftModule.getInstance().addEventListener(GiftDataEvent.GIFT_DATA_RES,this.onInitGiftData,this),this.dataService_gift=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.GIFT_SERVICE_ID),GiftModule.getInstance().addEventListener(GiftDataEvent.GIFT_DATA_RES,this.initDataHandle,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.onTouchTapUseItem=function(t){var e=t.currentTarget,i=e.getItem().id,n=GiftModule.getInstance().getMyGiftById(i);if(e.getItem()){if(e.getItem().g_coin>0&&0==n.count)return void ToolUtil.createAlert("提示","已经用完",300,200);e.isSelected=!e.isSelected,e.isSelected?-1==this.curSelectIDS.indexOf(i)&&this.curSelectIDS.push(i):-1!=this.curSelectIDS.indexOf(i)&&this.curSelectIDS.splice(this.curSelectIDS.indexOf(i)),e.isSelected?this.useGift(i):this.unUseGift(i)}},n.initDataHandle=function(t){this.updateUseView()},n.updateUseView=function(){for(var t=[],e=[],i=GiftModule.getInstance().myGifts,n=0;n<i.length;n++){var s=i[n],a=GiftModule.getInstance().getGiftVOById(s.giftId);s.isGroup&&(a&&0==a.g_coin?t.push(a):e.push(a)),s.isUsing&&-1==this.curSelectIDS.indexOf(s.giftId)&&this.curSelectIDS.push(s.giftId)}for(var n=0;n<t.length;n++)t.length>0&&this.updateOrAdd(t[n]);for(var n=0;n<e.length;n++)e.length>0&&this.updateOrAdd(e[n])},n.removeItem=function(t){for(var e,i=0;i<this._listGroup.numChildren;i++){var n=this._listGroup.getChildAt(i);if(n.getItem()&&n.getItem().id==t){e=n;break}}e&&e.parent&&e.parent.removeChild(e),e&&e.depose(),this.invalidateDisplayList()},n.updateOrAdd=function(t){for(var e=!1,i=0;i<this._listGroup.numChildren;i++){var n=this._listGroup.getChildAt(i);if(n.getItem()&&n.getItem().id==t.id){n.item=t,e=!0;break}if(!n.getItem()){n.item=t,e=!0;break}}if(!e){var s=new UseItem;s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapUseItem,this),s.width=90,s.height=90,s.item=t,this._listGroup.addChild(s)}this.invalidateDisplayList()},n.onInitGiftData=function(t){this.updateUseView()},n.reveDataHandler=function(t){var e=t.data;if(e.serviceId==CmdUtil.CONFIG_SERVICE_ID)if(e.cmd==CmdUtil.ADD_GIFT_ADDITION_GROUP_RES){if(1==e.code){var i=e.jsonObj,n=GiftModule.getInstance().getGiftVOById(i);n&&this.updateOrAdd(n)}}else if(e.cmd==CmdUtil.DELETE_GIFT_ADDITION_GROUP_RES){var i=e.jsonObj;this.removeItem(i);var s=GiftModule.getInstance().getMyGiftById(i);s.isGroup=!1}},n.removeGroupHandler=function(t){var e=new BaseREQData;e.cmd=CmdUtil.DELETE_GIFT_ADDITION_GROUP,e.jsonObj={giftId:t},this.dataService_config.sendData(e)},n.addGroupHandler=function(t){var e=new BaseREQData;e.cmd=CmdUtil.ADD_GIFT_ADDITION_GROUP,e.jsonObj={giftId:t},this.dataService_config.sendData(e)},n.useGift=function(t){var e=new BaseREQData;e.cmd=CmdUtil.USE_GIFT_ADDITION,e.jsonObj={giftId:t},this.dataService_config.sendData(e)},n.unUseGift=function(t){var e=new BaseREQData;e.cmd=CmdUtil.DELETE_USE_GIFT_ADDITION,e.jsonObj={giftId:t},this.dataService_config.sendData(e)},n.btnHandler=function(t){GiftModule.getInstance().showList()},n.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i),this._bg.graphics.clear(),this._bg.graphics.beginFill(0,.5),this._bg.graphics.drawRect(0,0,e,i),this._bg.graphics.endFill(),this._btn&&this._listGroup&&(this._btn.x=90*this._listGroup.numChildren+3*this._listGroup.numChildren),this._btn&&this._btn.x<280&&(this._btn.x=280)},n.sendCurrentGifts=function(){if(this.curSelectIDS){var t=new BaseREQData;t.cmd=CmdUtil.SEND_GIFT,t.jsonObj={giftIds:this.curSelectIDS},this.dataService_gift.sendData(t)}else ToolUtil.createAlert("提示","请选择",300,200)},e}(eui.Component);egret.registerClass(UseModule,"UseModule");var UserinfoModule=function(t){function e(){t.call(this),this.createLab(),this._autoCheckBox=new eui.CheckBox,this._autoCheckBox.addEventListener(egret.Event.CHANGE,this.autoPlayHandler,this),this._autoCheckBox.y=200,this._autoCheckBox.label="开启自动赠送",this.addChild(this._autoCheckBox),LoginService.getInstance().addEventListener(LoginServiceEvent.LOGIN_SUCCESS,this.loginSuccessHandler,this),AppService.getInstance().initApp(),this.dataService_userinfo=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.UESRINGO_SERVICE_ID),this.dataService_userinfo.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),this.getUserinfoData(),this.dataService_config=SocketDataServiceFactory.getInstance().createSerivce(CmdUtil.CONFIG_SERVICE_ID),this.dataService_config.addEventListener(DataEvent.DATA_RECEIVE,this.reveDataHandler,this),this.getMyConfigData()}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},n.autoPlayHandler=function(t){this.setAutoPlay(this._autoCheckBox.$selected?1:0)},n.getMyConfigData=function(){var t=new BaseREQData,e=new Object;t.cmd=CmdUtil.GET_USER_CONFIG,t.jsonObj=e,this.dataService_config.sendData(t)},n.setAutoPlay=function(t){var e=new BaseREQData,i=new Object;i.autoPlay=t,e.cmd=CmdUtil.SET_AUTO_PLAY,e.jsonObj=i,this.dataService_config.sendData(e)},n.reveDataHandler=function(t){var e=t.data;e.serviceId==CmdUtil.UESRINGO_SERVICE_ID?e.cmd==CmdUtil.GET_USER_DATA_RES?this.doResUserinfoData(e):e.cmd==CmdUtil.UPDATE_USER_DATA_RES?this.doResUserinfoData(e):e.cmd==CmdUtil.GET_G_COIN_BROCAST&&this.doGetGcoinHandler(e):e.serviceId==CmdUtil.CONFIG_SERVICE_ID&&(e.cmd==CmdUtil.SET_AUTO_PLAY_RES?this.successAutoGiftsData(e):e.cmd==CmdUtil.GET_USER_CONFIG_RES&&(this._autoCheckBox.selected=e.jsonObj.autoPlay))},n.successAutoGiftsData=function(t){var e=t.code;1==e&&console.log("设置自动赠送礼物成功")},n.doGetGcoinHandler=function(t){var e=t.jsonObj.get_g_coin,i=t.jsonObj.cur_g_coin,n=new PopHideTip;n.width=200,n.height=100,n.content="恭喜您获得每分钟奖励金币:"+e,n.show(),this.g_coin=i,this.updateLab()},n.doResUserinfoData=function(t){var e=(t.code,t.jsonObj);this.m_coin=e.m_coin,this.g_coin=e.g_coin,this.total_org_ack_0=e.total_org_ack_0,this.curGateNum=e.curGateNum,this.litileTargetNum=e.litileTargetNum,this.updateLab();var i=new UserInfoUpdateEvent(UserInfoUpdateEvent.UPDATE_USER_INFO);i.data=e,AppService.getInstance().dispatchEvent(i)},n.getUserinfoData=function(){var t=new BaseREQData;t.cmd=CmdUtil.GET_USER_DATA,t.jsonObj={},this.dataService_userinfo.sendData(t)},n.createLab=function(){this._nameLab=new egret.TextField,this._nameLab.size=15,this._nameLab.width=200,this._nameLab.textColor=65280,this._nameLab.fontFamily="宋体",this._nameLab.textAlign=egret.HorizontalAlign.LEFT,this._nameLab.verticalAlign=egret.VerticalAlign.TOP,this._nameLab.strokeColor=255,this._nameLab.stroke=2,this.addChild(this._nameLab),this._mCoinLab=new egret.TextField,this._mCoinLab.y=17,this._mCoinLab.size=15,this._mCoinLab.width=200,this._mCoinLab.textColor=65280,this._mCoinLab.fontFamily="宋体",this._mCoinLab.textAlign=egret.HorizontalAlign.LEFT,this._mCoinLab.verticalAlign=egret.VerticalAlign.TOP,this._mCoinLab.strokeColor=255,this._mCoinLab.stroke=2,this.addChild(this._mCoinLab),this._gCoinLab=new egret.TextField,this._gCoinLab.y=34,this._gCoinLab.size=15,this._gCoinLab.width=200,this._gCoinLab.textColor=65280,this._gCoinLab.fontFamily="宋体",this._gCoinLab.textAlign=egret.HorizontalAlign.LEFT,this._gCoinLab.verticalAlign=egret.VerticalAlign.TOP,this._gCoinLab.strokeColor=255,this._gCoinLab.stroke=2,this.addChild(this._gCoinLab),this._totalOrgLab=new egret.TextField,this._totalOrgLab.y=51,this._totalOrgLab.size=15,this._totalOrgLab.width=200,this._totalOrgLab.textColor=65280,this._totalOrgLab.fontFamily="宋体",this._totalOrgLab.textAlign=egret.HorizontalAlign.LEFT,this._totalOrgLab.verticalAlign=egret.VerticalAlign.TOP,this._totalOrgLab.strokeColor=255,this._totalOrgLab.stroke=2,this.addChild(this._totalOrgLab),this._targetNumLab=new egret.TextField,this._targetNumLab.y=68,this._targetNumLab.size=15,this._targetNumLab.width=200,this._targetNumLab.textColor=65280,this._targetNumLab.fontFamily="宋体",this._targetNumLab.textAlign=egret.HorizontalAlign.LEFT,this._targetNumLab.verticalAlign=egret.VerticalAlign.TOP,this._targetNumLab.strokeColor=255,this._targetNumLab.stroke=2,this.addChild(this._targetNumLab),this.invalidateDisplayList()},n.updateLab=function(){this._mCoinLab.text="点卷:"+this.m_coin,this._gCoinLab.text="金币:"+this.g_coin,this._totalOrgLab.text="魅力:"+this.total_org_ack_0,this._targetNumLab.text="获得素人:"+this.litileTargetNum},n.loginSuccessHandler=function(t){if(this._nameLab){var e=LoginService.getInstance().currentUser.nickName;this._nameLab.text=e}},e}(eui.Component);egret.registerClass(UserinfoModule,"UserinfoModule");var BaseUser=function(){function t(){this.gender=0}var e=(__define,t);e.prototype;return t}();egret.registerClass(BaseUser,"BaseUser");var AppService=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},s.initApp=function(){LoginService.getInstance().addEventListener(LoginServiceEvent.LOGIN_FAIL,this.loginFailHandler,this),LoginService.getInstance().addEventListener(LoginServiceEvent.LOGIN_SUCCESS,this.loginSuccessHandler,this),LoginService.getInstance().addEventListener(LoginServiceEvent.LOGIN_OUT,this.loginOutHandler,this),this.startLogin()},s.loginSuccessHandler=function(t){},s.loginOutHandler=function(t){console.info(t.toString())},s.loginFailHandler=function(t){console.info(t.toString()),this.serverReady=!1,this.reTryStartLogin()},s.reTryStartLogin=function(){this.startLogin()},s.startLogin=function(){if(!this.serverReady){var t=GetQueryString("openid"),i=GetQueryString("access_token");t||i||(t=e.getInstance().configXML.testUser,i=e.getInstance().configXML.testUser);var n=e.getInstance().configXML.wxgetUserUrl+"?openid="+t+"&access_token="+i,s=new egret.URLLoader;s.dataFormat=egret.URLLoaderDataFormat.TEXT,s.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetError,this);var a=new egret.URLRequest(n);a.method=egret.URLRequestMethod.GET,s.load(a)}},s.onGetError=function(t){this.serverReady=!1;var e=t.target;e.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetError,this),this.reTryStartLogin()},s.onGetComplete=function(t){this.serverReady=!0;var e=t.target,i=e.data,n=i.toString(),s=JSON.parse(n);s.jsonObj?(LoginService.getInstance().startLogin(null,s.jsonObj.authKey),e.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetError,this)):ToolUtil.createAlert("提示","登陆超过每天最大次数，请明天再试",400,200)},i(s,"appWidth",function(){return this.stage.stageWidth}),i(s,"appHeight",function(){return this.stage.stageHeight}),e}(egret.EventDispatcher);egret.registerClass(AppService,"AppService");var LoginService=function(t){function e(){t.call(this),this.isLogined=!1,this.currentUser=new BaseUser,this.addListeners()}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.startLogin=function(t,e){SocketDataServiceFactory.getInstance().startLogin({uid:t,authkey:e})},n.logout=function(){SocketDataServiceFactory.getInstance().logout(),this.dispatchEvent(new LoginServiceEvent(LoginServiceEvent.LOGIN_OUT))},n.addListeners=function(){SocketDataServiceFactory.getInstance().addEventListener(WebSocketEvent.CONNECT_SUCCESS,this.connectSuccessHandler,this),SocketDataServiceFactory.getInstance().addEventListener(WebSocketEvent.DISCONNECT,this.disConnectHandler,this)},n.connectSuccessHandler=function(t){this.loginResult(t.data)},n.disConnectHandler=function(t){this.isLogined=!1,this.dispatchEvent(new LoginServiceEvent(LoginServiceEvent.LOGIN_FAIL))},n.loginResult=function(t){var e=t.jsonObj,i=t.code,n=t.notice;if(e&&1==i?(this.isLogined=!0,this.doUserObject(e),this.dispatchEvent(new LoginServiceEvent(LoginServiceEvent.LOGIN_SUCCESS))):6==i?(this.isLogined=!1,this.dispatchEvent(new LoginServiceEvent(LoginServiceEvent.SAME_LOGIN))):(this.isLogined=!1,this.dispatchEvent(new LoginServiceEvent(LoginServiceEvent.LOGIN_FAIL))),n){var s=new Alert;s.title="提示",s.content=n.toString(),s.offsetX=100,s.offsetY=-50,s.width=300,s.height=200,s.show()}},n.doUserObject=function(t){this.currentUser.uid=t.account,this.currentUser.nickName=t.nick,this.currentUser.gender=t.sex,this.currentUser.logo=t.logo},e}(egret.EventDispatcher);egret.registerClass(LoginService,"LoginService");var WindowService=function(t){function e(){t.call(this),this.layers=[],AppService.getInstance().addEventListener(egret.Event.RESIZE,this.onResizeHander,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.onResizeHander=function(t){for(var e=this.layers,i=0;i<e.length;i++){var n=e[i];n.ui&&(n.ui.width=AppService.getInstance().appWidth,n.ui.height=AppService.getInstance().appHeight,n&&(n.ui.x=(AppService.getInstance().appWidth-n.ui.width)/2),n.ui.validateDisplayList())}},e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},s.showInTopLayer=function(t,e){void 0===e&&(e=0);var i=null;0==e?this.layers.length>0&&(i=this.layers[this.layers.length-1]):i=this.layers[e],i&&i.ui&&i.ui.addChild(t)},s.addToSecondTopLayer=function(t){this.showInTopLayer(t,this.MAX_LAYER_INDEX-1)},i(s,"MAX_LAYER_INDEX",function(){return this.layers.length-1}),s.addToTopLayer=function(t){this.showInTopLayer(t)},s.getTopLayer=function(){var t=this.layers[this.layers.length-1];return t.ui},s.cacheLayer=function(t){this.layers.push({ui:t})},e}(egret.EventDispatcher);egret.registerClass(WindowService,"WindowService");var AssetsUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t}();egret.registerClass(AssetsUtil,"AssetsUtil");var CmdUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.GIFT_SERVICE_ID=1e4,t.UESRINGO_SERVICE_ID=10002,t.TARGET_SERVICE_ID=10001,t.CONFIG_SERVICE_ID=10003,t.SHOP_LIST_SERVICE_ID=10004,t.SEND_GIFT=100,t.SEND_GIFT_RES=101,t.INIT_GIFTS_DATA=102,t.INIT_GIFTS_DATA_RES=103,t.GET_USER_DATA=106,t.GET_USER_DATA_RES=107,t.LIST_MY_GIFTS=108,t.LIST_MY_GIFTS_RES=109,t.GET_G_COIN_BROCAST=112,t.INIT_TARGETS_DATA_RES=111,t.INIT_TARGETS_DATA=110,t.LIST_MY_ADDITIONS=116,t.LIST_MY_ADDITIONS_RES=117,t.UPDATE_USER_DATA_RES=118,t.SET_AUTO_PLAY=119,t.SET_AUTO_PLAY_RES=120,t.UPDATE_AUTO_GIFTS_DATA=123,t.GET_USER_CONFIG=124,t.GET_USER_CONFIG_RES=125,t.GET_RANK_DATA=114,t.GET_RANK_DATA_RES=115,t.GET_SHOP_DATA=126,t.GET_SHOP_DATA_RES=127,t.BUY_COMMIDITY_DATA=128,t.BUY_COMMIDITY_DATA_RES=129,t.BUY_GIFT_ADDITION=130,t.BUY_GIFT_ADDITION_RES=131,t.DELETE_USE_GIFT_ADDITION=132,t.DELETE_USE_GIFT_ADDITION_RES=133,t.USE_GIFT_ADDITION=134,t.USE_GIFT_ADDITION_RES=135,t.ADD_GIFT_ADDITION_GROUP=136,t.ADD_GIFT_ADDITION_GROUP_RES=137,t.DELETE_GIFT_ADDITION_GROUP=138,t.DELETE_GIFT_ADDITION_GROUP_RES=139,t}();egret.registerClass(CmdUtil,"CmdUtil");var ToolUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.createAlert=function(t,e,i,n){void 0===i&&(i=300),void 0===n&&(n=200);var s=new Alert;s.title=t,s.content=e,s.width=i,s.height=n,s.show()},t.createSureAlert=function(t,e,i,n,s,a){void 0===s&&(s=300),void 0===a&&(a=200);var r=new Alert;r.title=t,r.content=e,r.width=s,r.height=a,r.okFun=i,r.okLabel=n,r.show()},t.createTextFiled=function(t,e,i,n,s,a){void 0===a&&(a=!1);var r=new eui.Label;return r.size=e,r.width=i,r.height=n,r.textColor=s,r.fontFamily="宋体",r.textAlign=egret.HorizontalAlign.LEFT,r.verticalAlign=egret.VerticalAlign.TOP,r.text=t,r.bold=a,r},t.createLine=function(t,e,i){var n=new eui.Rect(t,e,i);return n},t}();egret.registerClass(ToolUtil,"ToolUtil");var AppView=function(t){function e(){t.call(this),this._bgModule=BgModule.getInstance(),this._bgModule.percentWidth=100,this._bgModule.percentHeight=100,this.addChild(this._bgModule),this._monsterModule=MonsterModule.getInstance(),this._monsterModule.percentWidth=100,this._monsterModule.percentHeight=100,this.addChild(this._monsterModule),this._giftModule=GiftModule.getInstance(),this._giftModule.percentWidth=100,this._giftModule.height=200,this.addChild(this._giftModule),this._hpModule=HPBarModule.getInstance(),this.addChild(this._hpModule),this._userinfoModule=UserinfoModule.getInstance(),this.addChild(this._userinfoModule),this._rankModule=RankInfoModule.getInstance(),this.addChild(this._rankModule),this._shopModule=ShopModule.getInstance(),this.addChild(this._shopModule),this._useModule=UseModule.getInstance(),this.addChild(this._useModule),this._giftEffect=GiftEffect.getInstance(),this.addChild(this._giftEffect),this._topLayer=new eui.Component,this.addChild(this._topLayer);for(var e=0;3>e;e++){var i=new eui.Component;i.x=0,i.y=0,this._topLayer.addChild(i),WindowService.getInstance().cacheLayer(i)}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i),this._giftModule&&(this._giftModule.y=this.height-this._giftModule.height),this._useModule&&(this._useModule.y=this.height-this._useModule.height,this._useModule.x=(this.width-this._useModule.width)/2),this._hpModule&&(this._hpModule.x=(this.width-this._hpModule.width)/2,this._hpModule.y=30),this._monsterModule&&this._monsterModule.updateView()},e}(eui.Component);egret.registerClass(AppView,"AppView");var CommonEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.GIFT_SEND_SUCCESS="GIFT_SEND_SUCCESS",e.GIFT_INIT_DATA_RES="GIFT_INIT_DATA_RES",e}(egret.Event);egret.registerClass(CommonEvent,"CommonEvent");var BaseDataService=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.recevieData=function(t){},n.sendData=function(t){if(!(t.serviceId>0))throw new Error("obj must set serviceId");SocketDataServiceFactory.getInstance().sendData(t.serviceId,t)},e}(egret.EventDispatcher);egret.registerClass(BaseDataService,"BaseDataService",["ISocketDataService","Object"]);var BaseREQData=function(){function t(t){void 0===t&&(t=0),this.serviceId=0,this.serviceId=t}var e=(__define,t);e.prototype;return t}();egret.registerClass(BaseREQData,"BaseREQData");var DataEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.DATA_RECEIVE="DATA_RECEIVE",e}(egret.Event);egret.registerClass(DataEvent,"DataEvent");var DataService=function(t){function e(e){t.call(this),this.serviceId=e}__extends(e,t);var i=(__define,e),n=i.prototype;return n.recevieData=function(t){var e=new DataEvent(DataEvent.DATA_RECEIVE);e.data=t,this.dispatchEvent(e)},n.sendData=function(t){t.serviceId=this.serviceId,SocketDataServiceFactory.getInstance().sendData(t.serviceId,t)},e}(BaseDataService);egret.registerClass(DataService,"DataService");var SocketDataServiceFactory=function(t){function e(){t.call(this),this.queueSend=[],this.loginInfo={},this.services=new Array}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.startLogin=function(t){this.loginInfo=t;var e=JSON.stringify(this.loginInfo);e=window.btoa(e),this.connectSocket(e)},n.connectSocket=function(t){var e=this.callBackData;this.socket=io.connect(AppService.getInstance().configXML.appServer+"?cp="+t,{forceNew:!0,reconnect:!1,reconnection:!1}),this.socket.on("connectResultEvent",function(t){e("connectResultEvent",t)}),this.socket.on("dataEvent",function(t){e("dataEvent",t)}),this.socket.on("disconnect",function(t){e("disconnect")}),this.socket.on("error",function(t){e("error")}),this.socket.on("close",function(t){e("close")}),this.socket.on("failed",function(t){e("failed")})},n.receiveData=function(t,i){void 0===i&&(i=null);var n;if("connectResultEvent"==t)n=new WebSocketEvent(WebSocketEvent.CONNECT_SUCCESS),n.data=i,this.dispatchEvent(n),1==i.code&&(this.isConnected=!0,this.doSendQueue());else if("disconnect"==t)e.getInstance().isConnected=!1,n=new WebSocketEvent(WebSocketEvent.DISCONNECT),n.data=i,this.dispatchEvent(n);else if("error"==t);else if("dataEvent"==t)for(var s=0;s<this.services.length;s++){var a=this.services[s];if(a.serviceId==i.serviceId){var r=new BaseREQData;r.cmd=i.cmd,r.code=i.code,r.notice=i.notice,r.jsonObj=i.jsonObj,r.fromUid=i.fromUid,r.serviceId=a.serviceId,a.service.recevieData(r)}}},n.callBackData=function(t,i){void 0===i&&(i=null),e.getInstance().receiveData(t,i)},n.doSendQueue=function(){for(;this.queueSend.length>0;){var t=this.queueSend.shift();
this.sendData(t.serviceId,t.sendData)}},n.sendData=function(t,e){this.isConnected?this.sendToSocket(t,e):this.queueSend.push({serviceId:t,sendData:e})},n.sendToSocket=function(t,e){var i=e;i.serviceId=t,this.socket.emit("dataEvent",i)},n.logout=function(){},n.createSerivce=function(t){var e=new DataService(t);return this.services.push({service:e,serviceId:t}),e},e}(egret.EventDispatcher);egret.registerClass(SocketDataServiceFactory,"SocketDataServiceFactory");var WebSocketEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n,null)}__extends(e,t);var i=(__define,e);i.prototype;return e.CONNECT_SUCCESS="CONNECT_SUCCESS",e.DISCONNECT="DISCONNECT",e}(egret.Event);egret.registerClass(WebSocketEvent,"WebSocketEvent");var LoadingUI=function(t){function e(){t.call(this),this.width=480,this.height=100,this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=0,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},n.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH;var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this._loadingView=new LoadingUI,this.stage.addChild(this._loadingView),RES.getResByUrl("resource/config.xml",this.onAppCofingComplete,this,RES.ResourceItem.TYPE_XML),AppService.getInstance().stage=this.stage,this.stage.addEventListener(egret.Event.RESIZE,this.onResizeHander,this),this.checkSize()},n.onAppCofingComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);for(var e=t,i={},n=0;n<e.children.length;n++){var s=e.children[n];void 0!=s.children&&s.children&&(i[s.localName]=Object(s.children[0]).text)}console.info(i),AppService.getInstance().configXML=i,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},n.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this._loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},n.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"preload"==t.groupName&&this._loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.onResizeHander=function(t){this.checkSize()},n.startCreateScene=function(){this._appView=new AppView,this.addChild(this._appView),this.checkSize()},n.checkSize=function(){this._appView&&(this._appView.width=this.stage.stageWidth,this._appView.height=this.stage.stageHeight),this._loadingView&&(this._loadingView.x=(this.stage.stageWidth-this._loadingView.width)/2,this._loadingView.y=(this.stage.stageHeight-this._loadingView.height)/2),AppService.getInstance().dispatchEvent(new egret.Event(egret.Event.RESIZE))},e}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);